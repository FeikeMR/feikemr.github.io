<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Test Step 3</title>

  <style>
    #thankyouPopup {
      display: none;
      border: 2px solid green;
      padding: 1rem;
      margin-top: 1rem;
      max-width: 400px;
      background: #e1fce1;
    }
  </style>
</head>
<body>
  <h2>Step 3: Send form data to the server, then show "Thank you"</h2>
  
  <form id="feedbackForm">
    <p><label>Name: <input type="text" name="naam" required></label></p>
    <p><label>Email: <input type="email" name="email"></label></p>
    <p><label>Message: <textarea name="bericht"></textarea></label></p>
    
    <button type="submit">Send Feedback</button>
  </form>

  <div id="thankyouPopup">
    <h3>Thank you for your feedback!</h3>
    <p>We appreciate your input.</p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('feedbackForm');
      const thankyouPopup = document.getElementById('thankyouPopup');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();  // prevent page reload

        // Grab the data
        const formData = new FormData(form);

        try {
          // Send the data to our server's endpoint
          const response = await fetch('/submit-feedback', {
            method: 'POST',
            body: new URLSearchParams(formData),
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded'
            }
          });

          if (response.ok) {
            console.log("Form successfully sent to the server.");
            // Show the thank-you popup
            thankyouPopup.style.display = 'block';
          } else {
            console.log("Failed to submit form. Status:", response.status);
          }
        } catch(err) {
          console.error("Error sending form:", err);
        }
      });
    });
  </script>
</body>
</html>